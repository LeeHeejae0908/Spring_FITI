<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.spring.springwefit.placeboard.mapper.IPlaceBoardMapper">


	<sql id="search">
		<if test="condition == 'pbTitle'">
			WHERE pbTitle LIKE '%'||#{keyword}||'%'
		</if>
		<if test="condition == 'pbContent'">
			WHERE pbContent LIKE '%'||#{keyword}||'%'
		</if>
		<if test="condition == 'mNum'">
			WHERE mNum LIKE '%'||#{keyword}||'%'
		</if>
		<if test="condition == 'titleContent'">
			WHERE pbTitle LIKE '%'||#{keyword}||'%'
			OR pbContent LIKE '%'||#{keyword}||'%'
		</if>
	</sql>


	<insert id="regist">
		INSERT INTO PlaceBoard(pbNum, mNum, pbTitle, pbCategory, 
								pbAddrBasic, pbLatitude, pbLongitude, pbLookCount, pbImageCount, pbRegDate)
		VALUES(placeboard_seq.NEXTVAL, #{pbNum}, #{mNum}, #{pbTitle}, #{pbCategory}, #{pbAddrBasic}, 
										#{pbLatitude}, #{pbLongitude}, #{pbLookCount}, #{pbImageCount}, #{pbRegDate})		
	</insert>


	<select id="getList"
		resultType="com.spring.springwefit.command.PlaceBoardVO">
		SELECT * FROM
			(
			SELECT ROWNUM as rn, tbl.* FROM
				(
				SELECT * FROM PlaceBoard
				<include refid="search" />
				ORDER BY pbNum DESC
				) tbl
			)
		<![CDATA[
		WHERE rn > (#{pageNum} - 1) * #{countPerPage}
		AND rn <= #{pageNum} * #{countPerPage}
		]]>
	</select>



	<select id="getTotal" resultType="int">
		SELECT COUNT(*)
		FROM PlaceBoard
		<include refid="search" />
	</select>




	<select id="getContent"
		resultType="com.spring.springwefit.command.PlaceBoardVO">
		SELECT * FROM PlaceBoard
		WHERE pbNum = #{pbNum}
	</select>

	<update id="update">
		UPDATE PlaceBoard
		SET pbTitle=#{pbTitle},
		pbContent=#{pbContent}
		WHERE pbNum=#{pbNum}
	</update>

	<delete id="delete">
		DELETE FROM PlaceBoard
		WHERE pbNum=#{pbNum}
	</delete>




</mapper>


